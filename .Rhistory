scale_shape_manual(values=c(19, 1)) +
scale_color_manual("coral") +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform during tone (out of 20(s))", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none")
p_Plat_avg_adol
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.7), fill = "coral", color = "black", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.7, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform during tone (out of 20(s))", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none")
p_Plat_avg_adol
setwd('C:/Users/Gabrielle/Documents/GitHub/aac_pilot')
library(readxl); library(writexl);library(ggplot2); library(forcats); library(ggsci); library(patchwork); library(ez); library(rstatix); library(multcomp);
library(tidyverse); library(cowplot); library(car); library(lme4); library(afex)
fig_stats <- function(x)
{x %>% summarize(mean = mean(Time),
sd   = sd(Time),
n    = n(),
sem  = sd / sqrt(n))}
theme_set(
theme_light() +
theme(legend.justification = c(1, 1),
legend.box.margin = margin(t = 5, r = 5, b = 0, l = 0),
panel.grid = element_blank(),
text = element_text(size = 22),
title = element_text(size = 22),
legend.text = element_text(size = 18),
axis.text = element_text(size = 18),
axis.line = element_line(colour = "black", size = 0.3),
panel.border = element_blank())
)
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.7), fill = "coral", color = "black", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.7, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform during tone (out of 20(s))", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none")
p_Plat_avg_adol
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.7), fill = "coral", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.7, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform during tone (out of 20(s))", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none")
p_Plat_avg_adol
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.7), fill = "rosybrown1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.7, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform during tone (out of 20(s))", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none")
p_Plat_avg_adol
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.7), fill = "rosybrown1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.2, size =  0.7, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform during tone (out of 20(s))", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none")
p_Plat_avg_adol
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.7), fill = "rosybrown1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.8, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform during tone (out of 20(s))", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none")
p_Plat_avg_adol
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.7), fill = "rosybrown1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.8, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform (during 20s tone)", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none")
p_Plat_avg_adol
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.7), fill = "rosybrown1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.8, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform (during 20s tone)", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none", axis.text.x = element_text(size = 10))
p_Plat_avg_adol
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.7), fill = "rosybrown1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.8, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform (during 20s tone)", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none", axis.text.x = element_text(size = 5))
p_Plat_avg_adol
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.7), fill = "rosybrown1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.8, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform (during 20s tone)", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none", axis.text.y = element_text(size = 10))
p_Plat_avg_adol
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.7), fill = "rosybrown1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.8, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform (during 20s tone)", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none", axis.title.y = element_text(size = 10))
p_Plat_avg_adol
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.7), fill = "rosybrown1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.8, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform (during 20s tone)", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none", axis.title.y = element_text(size = 15))
p_Plat_avg_adol
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.7), fill = "rosybrown1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.8, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform (during 20s tone)", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none", axis.title.y = element_text(size = 15), axis.text.x = element_text(size = 12))
p_Plat_avg_adol
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.7), fill = "rosybrown1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.8, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform (during 20s tone)", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none", axis.title.y = element_text(size = 15), axis.text.x = element_text(size = 15))
p_Plat_avg_adol
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.7), fill = "rosybrown1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.8, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform (during 20s tone)", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none", axis.title.y = element_text(size = 15),
axis.text.x = element_text(size = 15), axis.text.xy = element_text(size = 15))
p_Plat_avg_adol
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.7), fill = "rosybrown1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.8, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform (during 20s tone)", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none", axis.title.y = element_text(size = 15),
axis.text.x = element_text(size = 15), axis.text.y = element_text(size = 15))
p_Plat_avg_adol
p_Plat_avg_adol <- ggplot (Plat_avg_adol, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.5), fill = "rosybrown1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.8, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform (during 20s tone)", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none", axis.title.y = element_text(size = 15),
axis.text.x = element_text(size = 15), axis.text.y = element_text(size = 15))
p_Plat_avg_adol
##### adult avoidance #####
Plat_avg_adul <- Plat_avg %>% filter(!Age == "Adolescent")
Plat_avg_adul <- Plat_avg_adul %>%
group_by(Day) %>%
temp_stats
p_Plat_avg_adul <- ggplot (Plat_avg_adul, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.5), fill = "lightblue1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.8, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform (during 20s tone)", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none", axis.title.y = element_text(size = 15),
axis.text.x = element_text(size = 15), axis.text.y = element_text(size = 15))
p_Plat_avg_adol
p_Plat_avg_adul <- ggplot (Plat_avg_adul, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.5), fill = "lightblue1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.8, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Avg time on platform (during 20s tone)", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none", axis.title.y = element_text(size = 15),
axis.text.x = element_text(size = 15), axis.text.y = element_text(size = 15))
p_Plat_avg_adul
p_Plat_avg_adul <- ggplot (Plat_avg_adul, aes(x = Day, y = mean)) +
geom_col(position = position_dodge2(width = 0.5), fill = "lightblue1", size = 0.2) +
#geom_point(size = 4, show.legend = FALSE) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.1, size =  0.8, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 4"))) + #"Day 3", #add this back when you get it
scale_y_continuous("Avg time on platform (during 20s tone)", limits = c(0, 20), breaks = seq(0, 20, 5), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none", axis.title.y = element_text(size = 15),
axis.text.x = element_text(size = 15), axis.text.y = element_text(size = 15))
p_Plat_avg_adul
#### graphing conflict ####
conflict <- read_xlsx(sheet = 9, 'handscore_percents.xlsx')
#### graphing conflict ####
conflict <- read_xlsx(sheet = 9, 'handscore-percents.xlsx')
View(Plat_avg_adol)
View(conflict)
conflict <- conflict %>% filter(!is.na = starts_with = "Port")
conflict <- conflict %>% filter(!is.na = (starts_with = "Port"))
conflict <- conflict %>% filter(!is.na == (starts_with = "Port"))
conflict <- conflict %>%
mutate(Port = rowMeans(x = select(.data = conflict, starts_with("Port")), na.rm = TRUE)) %>%
mutate(Platform = rowMeans(x = select(.data = conflict, starts_with("Platform")), na.rm = TRUE))
View(conflict)
#repeated measures mixed-effects model; since we want to look at between and within factors at the same time, acconts for individual variabilities as well
rm_adult_model <- lmer(Time ~ StimType * Sex + (1 | MouseID) + (1 | Day), data = am_acq_sub)
summary(rm_adult_model)
tidy(rm_adult_model)
install.packages("broom.mixed")
tidy(rm_adult_model)
#repeated measures mixed-effects model; since we want to look at between and within factors at the same time, acconts for individual variabilities as well
rm_adult_model <- lmer(Time ~ StimType * Sex + (1 | MouseID) + (1 | Day), data = am_acq_sub)
summary(rm_adult_model)
tidy(rm_adult_model)
#bonus repeated measures mixed-effects model; since we want to look at between and within factors at the same time, acconts for individual variabilities as well
rm_adoles_model <- lmer(Time ~ StimType * Sex + (1 | MouseID) + (1 | Day), data = am_acq_ado)
summary(rm_adoles_model)
#levenes test for variances in factors  - theres violations but sample sizes are similar so we're gonna ball (use anova)
lev_day <- leveneTest(Time ~ Day, data = am_acq_ado)
lev_day #there are significant differences in variances across the levels of the Day factor
#repeated measures mixed-effects model; since we want to look at between and within factors at the same time, acconts for individual variabilities as well
rm_adult_model <- lmer(Time ~ StimType * Sex + (1 | MouseID) + (1 | Day), data = am_acq_sub)
summary(rm_adult_model)
#bonus repeated measures linear mixed-effects model; since we want to look at between and within factors at the same time, acconts for individual variabilities as well
rm_adoles_model <- lmer(Time ~ StimType * Sex + (1 | MouseID) + (1 | Day), data = am_acq_ado)
summary(rm_adoles_model)
setwd('C:/Users/Gabrielle/Documents/GitHub/aac_pilot')
library(readxl); library(writexl);library(ggplot2); library(forcats); library(ggsci); library(patchwork); library(ez); library(rstatix); library(multcomp);
library(tidyverse); library(cowplot); library(car); library(lme4); library(afex); library(broom.mixed)
fig_stats <- function(x)
{x %>% summarize(mean = mean(Time),
sd   = sd(Time),
n    = n(),
sem  = sd / sqrt(n))}
theme_set(
theme_light() +
theme(legend.justification = c(1, 1),
legend.box.margin = margin(t = 5, r = 5, b = 0, l = 0),
panel.grid = element_blank(),
text = element_text(size = 22),
title = element_text(size = 22),
legend.text = element_text(size = 18),
axis.text = element_text(size = 18),
axis.line = element_line(colour = "black", size = 0.3),
panel.border = element_blank())
)
#### demographics ####
pnd_stats <- function(x)
{x %>% summarize(mean = mean(PND),
max = max(PND),
min = min(PND),
sd   = sd(PND),
n    = n(),
sem  = sd / sqrt(n))}
AM1 <- read_xlsx(sheet = 1, 'handscore-percents.xlsx')
AM2 <- read_xlsx(sheet = 2, 'handscore-percents.xlsx')
AM3 <- read_xlsx(sheet = 3, 'handscore-percents.xlsx')
AM4 <- read_xlsx(sheet = 4, 'handscore-percents.xlsx')
AM1_long <- AM1 %>%
mutate(Cue = rowMeans(x = select(.data = AM1, starts_with("Appetitive")), na.rm = TRUE)) %>%
mutate(PreCue = rowMeans(x = select(.data = AM1, starts_with("ITI")), na.rm = TRUE)) %>%
select(MouseID:Age, Cue, PreCue) %>% mutate(Day = "Day1") %>%
pivot_longer(cols = Cue:PreCue, names_to = "StimType", values_to = "Time")
AM2_long <- AM2 %>%
mutate(Cue = rowMeans(x = select(.data = AM2, starts_with("Appetitive")), na.rm = TRUE)) %>%
mutate(PreCue = rowMeans(x = select(.data = AM2, starts_with("ITI")), na.rm = TRUE)) %>%
select(MouseID:Age, Cue, PreCue) %>% mutate(Day = "Day2") %>%
pivot_longer(cols = Cue:PreCue, names_to = "StimType", values_to = "Time")
AM3_long <- AM3 %>%
mutate(Cue = rowMeans(x = select(.data = AM3, starts_with("Appetitive")), na.rm = TRUE)) %>%
mutate(PreCue = rowMeans(x = select(.data = AM3, starts_with("ITI")), na.rm = TRUE)) %>%
select(MouseID:Age, Cue, PreCue) %>% mutate(Day = "Day3") %>%
pivot_longer(cols = Cue:PreCue, names_to = "StimType", values_to = "Time")
AM4_long <- AM4 %>%
mutate(Cue = rowMeans(x = select(.data = AM4, starts_with("Appetitive")), na.rm = TRUE)) %>%
mutate(PreCue = rowMeans(x = select(.data = AM4, starts_with("ITI")), na.rm = TRUE)) %>%
select(MouseID:Age, Cue, PreCue) %>% mutate(Day = "Day4") %>%
pivot_longer(cols = Cue:PreCue, names_to = "StimType", values_to = "Time")
Acquisition <- bind_rows(AM1_long, AM2_long, AM3_long, AM4_long)
Acquisition <- Acquisition %>% filter(!is.na(Time))
#### APPETITIVE ACQUISITION CURVES ####
#ADULTS - graph the data
am_acq <- read_xlsx(sheet = 1, 'RaltsHand_Acq.xlsx')
am_acq_sub <- am_acq %>% filter(Age == "Adult")
am_acq_sub_stats <- am_acq_sub %>%
group_by(StimType, Day, Sex) %>%
fig_stats %>%
unite(Group, c(Sex, StimType), sep = " ", remove = FALSE)
p_Acq <- ggplot(am_acq_sub_stats, aes(x = Day, y = mean, group = Group)) +
geom_point(aes(shape = Sex, color = StimType), size = 4, show.legend = FALSE) +
geom_line(aes(linetype = Sex, color = StimType), lwd = 2) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.05, size = 1, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_color_manual(values=c("orange2", "steelblue1")) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) + #"Day 2", can be added back after we actually get data for that
scale_y_continuous("Average time in port (%)", limits = c(0, 100), breaks = seq(0, 100, 10), expand = c(0, 0)) +
#ggtitle("Adult") +
theme(legend.position = "none")
p_Acq
#### ADULTS - analyze the data - adults ####
adult_rm_anova <- anova_test(
data = am_acq_sub,
dv= Time,
wid = MouseID,
within = c(Day, StimType)
)
adult_rm_anova
#effect of stimtype
adultstim_ph <- am_acq_sub %>% group_by(StimType) %>% fig_stats()
adultstim_ph #adults spend significantly more time in the port during cue than during precue :)
#effect of day
adultday_ph <- am_acq_sub %>% group_by(Day) %>% fig_stats()
adultday_ph #adults spend significantly more time in the port during cue than during precue :)
#effect of day:stimtype
adult_ds_ph <- am_acq_sub %>%
group_by(Day) %>%
t_test(Time ~ StimType)
adult_ds_ph
adult_ds_ph_bon <- p.adjust(adult_ds_ph$p, method = "bonferroni")
adult_ds_ph_bon #significant difference in time in port during cue or precue starting on day 1
#repeated measures mixed-effects model; since we want to look at between and within factors at the same time, acconts for individual variabilities as well
rm_adult_model <- lmer(Time ~ StimType * Sex + (1 | MouseID) + (1 | Day), data = am_acq_sub)
summary(rm_adult_model)
#### ADOLESCENTS graph the data ####
am_acq_ado <- am_acq %>% filter(Age == "Adolescent")
am_acq_ado_stats <- am_acq_ado %>%
filter(!is.na(Time)) %>%
group_by(StimType, Day, Sex) %>%
fig_stats %>%
unite(Group, c(Sex, StimType), sep = " ", remove = FALSE)
p_acq_adol <- ggplot(am_acq_ado_stats, aes(x = Day, y = mean, group = Group)) +
geom_point(aes(shape = Sex, color = StimType), size = 4, show.legend = FALSE) +
geom_line(aes(linetype = Sex, color = StimType), lwd = 2) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.05, size = 1, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_color_manual(values=c("orange2", "steelblue1")) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Average time in port (%)", limits = c(0, 100), breaks = seq(0, 100, 10), expand = c(0, 0)) +
#ggtitle("Adolescent") +
theme(legend.position = "none")
p_acq_adol
#### ADOLESCENTS analyze the data ####
# Ensure Day and StimType are factors
am_acq_ado$Day <- as.factor(am_acq_ado$Day)
am_acq_ado$StimType <- as.factor(am_acq_ado$StimType)
#levenes test for variances in factors  - theres violations but sample sizes are similar so we're gonna ball (use anova)
lev_day <- leveneTest(Time ~ Day, data = am_acq_ado)
lev_day #there are significant differences in variances across the levels of the Day factor
lev_stim <- leveneTest(Time ~ StimType, data = am_acq_ado)
lev_stim #there are significant differences in variances across the stimtype factor
#bonus repeated measures linear mixed-effects model; since we want to look at between and within factors at the same time, acconts for individual variabilities as well
rm_adoles_model <- lmer(Time ~ StimType * Sex + (1 | MouseID) + (1 | Day), data = am_acq_ado)
summary(rm_adoles_model)
#RM anova despite violation of variance because screw it we ball
adoles_rm_anova <- anova_test(
data = am_acq_ado,
dv= Time,
wid = MouseID,
within = c(Day, StimType)
)
adoles_rm_anova
#unpack Day
adol_day_ph <- am_acq_ado %>% group_by(Day) %>% fig_stats()
adol_day_ph
#unpack Stimtype
adol_stim_ph <- am_acq_ado %>% group_by(StimType) %>% fig_stats()
adol_stim_ph # sig more time in port during cue than during precue
#unpack Day x Stimtype (no levene's for paired t-tests - but levene for anova)
adol_sd_ph <- am_acq_ado %>% group_by(Day) %>% t_test(Time ~ StimType, var.equal = FALSE, paired = TRUE)
adol_sd_ph #more time in port during cue than during precue starting on day 2
#unpack marginal sex interaction
adol_day_ph <- am_acq_ado %>% group_by(Sex) %>% fig_stats()
adol_day_ph #females spending slightly more time in port regardless of stim type
##understand that huge variance on d4 les go
adol_day_4 <- am_acq_ado[am_acq_ado$Day == 4,]
##understand that huge variance on d4 les go
adol_day_4 <- am_acq_ado[am_acq_ado$Day == 4,]
adol_day123 <- am_acq_ado[am_acq_ado$Day != 4,]
View(adol_day_4)
View(adol_day123)
##understand that huge variance on d4 les go
adol_day_4 <- am_acq_ado[am_acq_ado$Day == "Day4",]
adol_day123 <- am_acq_ado[am_acq_ado$Day != "Day4",]
##understand that huge variance on d4 les go
adol_day_4 <- am_acq_ado[am_acq_ado$Day == "Day4", am_acq_ado$StimType == "Cue",]
adol_day_4 <- adol_day_4 %>% filter(!StimType == "PreCue")
adol_day123 <- am_acq_ado[am_acq_ado$Day != "Day4",]
adol_day_123 <- adol_day_123 %>% filter(!StimType == "PreCue")
adol_day123 <- am_acq_ado[am_acq_ado$Day != "Day4",]
adol_day123 <- adol_day123 %>% filter(!StimType == "PreCue")
adol_dayvar <- rbind(adol_day_4, adol_day123)
View(adol_dayvar)
adol_dayvar <- rbind(adol_day_4, adol_day123)
adol_dayvar$Group <- factor(c(rep("Day4", nrow(adol_day_4)), rep("OtherDays", nrow(adol_day123))))
leveneTest(measurement ~ Group, data = adol_dayvar)
leveneTest(Time ~ Group, data = adol_dayvar)
adol_day4_pc <- am_acq_ado[am_acq_ado$Day == "Day4"]
adol_day_4_pc <- adol_day_4 %>% filter(!StimType == "Cue")
adol_stimvar <- rbind(adol_day_4, adol_day_4_pc)
adol_stimvar$Group <- factor(c(rep("Day4Cue", nrow(adol_day_4)), rep("Day4PreCue", nrow(adol_day_4_pc))))
adol_day_4_pc <- adol_day_4 %>% filter(!StimType == "Cue")
adol_stimvar <- rbind(adol_day_4, adol_day_4_pc)
adol_stimvar$Group <- factor(c(rep("Day4Cue", nrow(adol_day_4)), rep("Day4PreCue", nrow(adol_day_4_pc))))
leveneTest(Time ~ Group, data = adol_stimvar)
View(adol_stimvar)
adol_day_4_pc <- adol_day_4 %>% filter(!StimType == "Cue")
View(adol_day_4_pc)
View(adol_day_4)
adol_day_4_pc <- am_acq_ado[am_acq_ado$Day == "Day4"]
View(am_acq_ado)
adol_day_4_pc <- subset(am_acq_ado, Day == "Day4")
View(adol_day_4_pc)
adol_day_4_pc %>% filter(!StimType == "Cue")
adol_day_4_pc <- adol_day_4_pc %>% filter(!StimType == "Cue")
adol_stimvar <- rbind(adol_day_4, adol_day_4_pc)
adol_stimvar$Group <- factor(c(rep("Day4Cue", nrow(adol_day_4)), rep("Day4PreCue", nrow(adol_day_4_pc))))
leveneTest(Time ~ Group, data = adol_stimvar)
#repeated measures mixed-effects model; since we want to look at between and within factors at the same time, acconts for individual variabilities as well
rm_adult_model <- lmer(Time ~ StimType * Sex + (1 | MouseID) + (1 | Day), data = am_acq_sub)
summary(rm_adult_model)
model_interaction <- lmer(Time ~ StimType * Sex * Age + (1 | MouseID) + (1 | Day), data = am_acq)
model_interaction
##### CUE DIFFERENCES ##### Across sex and age - cue learning #####
am_acq_full <- am_acq %>%
filter(!is.na(Time)) %>%
filter(StimType != "PreCue")
ac_anova_model <- anova_test(data = am_acq_full, dv = Time, wid = MouseID, between = c(Age, Sex), within = Day, effect.size = "pes")
ac_anova_model
# Age
Age_ph <- am_acq_full %>% group_by(Age) %>% fig_stats
Age_ph #adolescents and adults averaging the same amount of time in port during the precue
#day
Day_ph <- am_acq_full %>% group_by(Day) %>% fig_stats
Day_ph
#AgeDay t-test and bonferroni correction
AgeDay_ph <- am_acq_full %>%
group_by(Day) %>%
t_test(Time ~ Age)
AgeDay_ph
##### PRE CUE DIFFERENCES - across sex and age #######
am_acq_fullp <- am_acq %>%
filter(!is.na(Time)) %>%
filter(StimType != "Cue") #day 2 is missing for adults so we are going to get rid of it for now
ac_anova_model <- anova_test(data = am_acq_fullp, dv = Time, wid = MouseID, between = c(Age, Sex), within = Day, effect.size = "pes")
ac_anova_model
#main effect of age
Age_ph <- am_acq_fullp %>% group_by(Age) %>% fig_stats
Age_ph #adolescents and adults averaging the same amount of time in port during the cue
#main effect of day
Day_ph <- am_acq_fullp %>% group_by(Day) %>% fig_stats
Day_ph #looks like a lot more time in port on day 3
AgeDaypre_ph <- am_acq_fullp %>%
group_by(Day) %>%
t_test(Time ~ Age)
AgeDaypre_ph
AgeDaypre_ph_bon <- p.adjust(AgeDay_ph$p, method = "bonferroni")
AgeDaypre_ph_bon
platavg_model <- anova_test(data = Plat_avgfull, dv = Temp, wid = MouseID, between = Age, within = Day, effect.size = "pes")
#### AVOIDANCE ####
temp_stats <- function(x)
{x %>% summarize(mean = mean(Temp),
sd   = sd(Temp),
n    = n(),
sem  = sd / sqrt(n))}
avoid <- read_xlsx('avoid.xlsx')
