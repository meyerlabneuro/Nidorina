group_by(Sex, Age) %>% #group by sex
fig_stats() #%>%
p_OFC <- ggplot(OFC_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = OFC_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 0.7, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("red3", "purple3", "steelblue1")) +
theme(legend.position = c(1,1))
p_OFC
p_IL <- ggplot(IL_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = IL_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 0.7, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("red3", "steelblue1")) +
theme(legend.position = c(1,1))
p_IL
p_OFC <- ggplot(OFC_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = OFC_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 0.7, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("red3", "steelblue1")) +
theme(legend.position = c(1,1))
p_OFC
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 0.7, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("red3", "steelblue1")) +
theme(legend.position = c(1,1))
p_pl
Fear <- cor.test(OFC_performance_wide$Ratio, OFC_performance_wide$Fear)
Fear
Compound <- cor.test(OFC_performance_wide$Ratio, OFC_performance_wide$Compound)
Compound
Safety <- cor.test(OFC_performance_wide$Ratio, OFC_performance_wide$Safety)
Safety
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 0.7, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("red3", "steelblue1")) +
theme(legend.position = c(1,1))
#setwd('/Users/hcmeyer/Meyer Lab Boston University/Research/Experiments/Nidorina')
library(dplyr); library(tidyr); library(readxl); library(writexl); library(forcats); library(ggsci); library(patchwork); library(ez); library(rstatix); library(multcomp); library(tidyverse); library(cowplot); library(car)
####figure stats for ratio graphs
fig_stats <- function(x)
{x %>% summarize(mean = mean(Value, na.rm =TRUE),
sd   = sd(Value, na.rm =TRUE),
n    = n(),
sem  = sd(Value, na.rm =TRUE) / sqrt(n()))}
theme_set(
theme_light() +
theme(legend.justification = c(1, 1),
legend.box.margin = margin(t = 5, r = 5, b = 0, l = 0),
panel.grid = element_blank(),
text = element_text(size = 22),
title = element_text(size = 22),
legend.text = element_text(size = 18),
axis.text = element_text(size = 18),
axis.line = element_line(colour = "black", size = 0.3),
panel.border = element_blank())
)
#Analyze by age, sex
Prelimbic <- read_xlsx(sheet = 2, 'NofS_PL ratios.xlsx')
Prelimbic_model <- anova_test(data = Prelimbic, dv = Ratio, wid = MouseID, between = c(Age, Sex), effect.size = "pes")
Prelimbic_model
Infralimbic <- read_xlsx(sheet = 2, 'NofS_IL ratios.xlsx')
Infralimbic_model <- anova_test(data = Infralimbic, dv = Ratio, wid = MouseID, between = c(Age, Sex), effect.size = "pes")
Infralimbic_model
IL_ph <- Infralimbic %>% t_test(Ratio ~ Age, var.equal = TRUE, paired = FALSE)
IL_ph
Orbitofrontal <- read_xlsx(sheet = 2, 'NofS_OFC ratios.xlsx')
Orbitofrontal_model <- anova_test(data = Orbitofrontal, dv = Ratio, wid = MouseID, between = c(Age, Sex), effect.size = "pes")
Orbitofrontal_model
OFC_ph <- Orbitofrontal %>% t_test(Ratio ~ Age, var.equal = TRUE, paired = FALSE)
OFC_ph
#Analyze by performance
Summation <- read_xlsx('Nido_Summation_Fos.xlsx') %>% rename(Value = Freezing) %>% rename(Variable = StimType)
#Prelimbic performance wide table
Prelimbic <- Prelimbic %>% rename(Value = Ratio)
PL_performance <- bind_rows(Prelimbic, Summation)
PL_performance_wide <- PL_performance %>% pivot_wider(names_from = Variable, values_from = Value) %>%
select(MouseID:Age, Ratio, Fear, Compound, Safety, Discrim, Suppression) %>%
filter(!is.na(Ratio))
Fear <- cor.test(PL_performance_wide$Ratio, PL_performance_wide$Fear)
Fear
Compound <- cor.test(PL_performance_wide$Ratio, PL_performance_wide$Compound)
Compound
Safety <- cor.test(PL_performance_wide$Ratio, PL_performance_wide$Safety)
Safety
Discrim <- cor.test(PL_performance_wide$Ratio, PL_performance_wide$Discrim)
Discrim
Suppress <- cor.test(PL_performance_wide$Ratio, PL_performance_wide$Suppression)
Suppress
#### PRELIMBIC RATIO GRAPH
#the ratio graphs - copy this and make one for each region!!!!
write_xlsx(PL_performance, 'PL_performance.xlsx')
pl <- read_xlsx('PL_performance.xlsx')
pl_sub <- pl %>%
filter(Variable == "Ratio") #only get ratios
pl_sub_stats <- pl_sub %>% #either sex or age
group_by(Sex, Age) %>% #group by sex
fig_stats() #%>%
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 0.7, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("red3", "steelblue1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("red3", "steelblue1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.3, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.2, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.5)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 2) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.8), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.6), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 20, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 20, stroke = 1, color = group, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex, color = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 20, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex, color = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, group = Sex, color = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, group = Sex, fill = Sex, color = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, group = Sex, fill = Sex, color = "black"), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, group = Sex, fill = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
#Infralimbic
Infralimbic <- Infralimbic %>% rename(Value = Ratio)
IL_performance <- bind_rows(Infralimbic, Summation)
IL_performance_wide <- IL_performance %>% pivot_wider(names_from = Variable, values_from = Value) %>%
select(MouseID:Age, Ratio, Fear, Compound, Safety, Discrim, Suppression) %>%
filter(!is.na(Ratio))
#### INFRALIMBIC RATIO GRAPH
#the ratio graphs - copy this and make one for each region!!!!
write_xlsx(IL_performance, 'PL_performance.xlsx')
IL <- read_xlsx('PL_performance.xlsx')
IL_sub <- IL %>%
filter(Variable == "Ratio") #only get ratios
IL_sub_stats <- IL_sub %>% #either sex or age
group_by(Sex, Age) %>% #group by sex
fig_stats() #%>%
p_IL <- ggplot(IL_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = IL_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 0.7, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("red3", "steelblue1")) +
theme(legend.position = c(1,1))
p_IL
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, group = Sex, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_IL <- ggplot(IL_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = IL_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_IL
#### ORBITOFRONTAL RATIO GRAPH
#the ratio graphs - copy this and make one for each region!!!!
write_xlsx(OFC_performance, 'PL_performance.xlsx')
OFC <- read_xlsx('PL_performance.xlsx')
OFC_sub <- OFC %>%
filter(Variable == "Ratio") #only get ratios
OFC_sub_stats <- OFC_sub %>% #either sex or age
group_by(Sex, Age) %>% #group by sex
fig_stats() #%>%
p_OFC <- ggplot(OFC_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = OFC_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 1), breaks = seq(0, 1, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_OFC
p_OFC <- ggplot(OFC_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = OFC_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 0.5), breaks = seq(0, 0.5, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_OFC
p_OFC <- ggplot(OFC_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = OFC_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 0.52), breaks = seq(0, 0.52, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_OFC
p_pl <- ggplot(pl_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = pl_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, group = Sex, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 0.52), breaks = seq(0, 0.52, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_pl
p_IL <- ggplot(IL_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = IL_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 0.52), breaks = seq(0, 0.52, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_IL
p_OFC <- ggplot(OFC_sub_stats, aes(x = Age, y = mean, fill = Sex)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = OFC_sub, inherit.aes = FALSE,
aes(x = Age, y = Value, fill = Sex, group = Sex), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 2.5) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 1, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("cFos/DAPI", limits = c(0, 0.52), breaks = seq(0, 0.52, 0.1), expand = c(0, 0)) +
scale_fill_manual(name = NULL, values = c("darksalmon", "slategray1")) +
theme(legend.position = c(1,1))
p_OFC
