#setwd('/Users/hcmeyer/Meyer Lab Boston University/Research/Experiments/Nidorina')
library(readxl); library(writexl);library(ggplot2); library(forcats); library(ggsci); library(patchwork); library(ez); library(rstatix); library(multcomp); library(tidyverse); library(cowplot); library(car)
fig_stats <- function(x)
{x %>% summarize(mean = mean(Freezing),
sd   = sd(Freezing),
n    = n(),
sem  = sd / sqrt(n))}
theme_set(
theme_light() +
theme(legend.justification = c(1, 1),
legend.box.margin = margin(t = 5, r = 5, b = 0, l = 0),
panel.grid = element_blank(),
text = element_text(size = 22),
title = element_text(size = 22),
legend.text = element_text(size = 18),
axis.text = element_text(size = 18),
axis.line = element_line(colour = "black", size = 0.3),
panel.border = element_blank())
)
#
#### Curate data ####
#Acquisition
SS1 <- read_xlsx(sheet = 2, 'Nidorina_masterdoc_MT8.xlsx') #All data is MT8
#
#### Curate data ####
#Acquisition
SS1 <- read_xlsx(sheet = 2, 'Nidorina_masterdoc_MT8.xlsx') #All data is MT8
SS2 <- read_xlsx(sheet = 3, 'Nidorina_masterdoc_MT8.xlsx')
SS3 <- read_xlsx(sheet = 4, 'Nidorina_masterdoc_MT8.xlsx')
SS4 <- read_xlsx(sheet = 5, 'Nidorina_masterdoc_MT8.xlsx')
SS1_long <- SS1 %>%
mutate(Fear = rowMeans(x = select(.data = SS1, starts_with("Fear")))) %>%
mutate(Safety = rowMeans(x = select(.data = SS1, starts_with("Safety")))) %>%
mutate(Discrim = Fear - Safety) %>%
select(MouseID:Age, Baseline, Fear, Safety, Discrim) %>% mutate(Day = "Day1") %>%
pivot_longer(cols = Baseline:Discrim, names_to = "StimType", values_to = "Freezing")
SS2_long <- SS2 %>%
mutate(Fear = rowMeans(x = select(.data = SS2, starts_with("Fear")))) %>%
mutate(Safety = rowMeans(x = select(.data = SS2, starts_with("Safety")))) %>%
mutate(Discrim = Fear - Safety) %>%
select(MouseID:Age, Baseline, Fear, Safety, Discrim) %>% mutate(Day = "Day2") %>%
pivot_longer(cols = Baseline:Discrim, names_to = "StimType", values_to = "Freezing")
SS3_long <- SS3 %>%
mutate(Fear = rowMeans(x = select(.data = SS3, starts_with("Fear")))) %>%
mutate(Safety = rowMeans(x = select(.data = SS3, starts_with("Safety")))) %>%
mutate(Discrim = Fear - Safety) %>%
select(MouseID:Age, Baseline, Fear, Safety, Discrim) %>% mutate(Day = "Day3") %>%
pivot_longer(cols = Baseline:Discrim, names_to = "StimType", values_to = "Freezing")
SS4_long <- SS4 %>%
mutate(Fear = rowMeans(x = select(.data = SS4, starts_with("Fear")))) %>%
mutate(Safety = rowMeans(x = select(.data = SS4, starts_with("Safety")))) %>%
mutate(Discrim = Fear - Safety) %>%
select(MouseID:Age, Baseline, Fear, Safety, Discrim) %>% mutate(Day = "Day4") %>%
pivot_longer(cols = Baseline:Discrim, names_to = "StimType", values_to = "Freezing")
Acquisition <- bind_rows(SS1_long, SS2_long, SS3_long, SS4_long)
Acquisition <- Acquisition %>% filter(!is.na(Freezing))
write_xlsx(Acquisition, 'Nido_Acquisition.xlsx')
#curate the data
Summation <- read_xlsx(sheet = 7, 'Nidorina_masterdoc_MT8.xlsx')
Summation_Fos <- Summation %>%
filter(!Cohort == "1", !Cohort == "2", !Cohort == "3", !Cohort == "4", !Cohort == "5", !Cohort == "Combo") %>%
select(MouseID, Sex, Age, Baseline:Safety) %>%
mutate(Discrim = Fear - Safety) %>%
mutate(Inhib = Fear - Compound) %>%
mutate(Suppression = Compound/Fear) %>%
pivot_longer(cols = Baseline:Suppression, names_to = "StimType", values_to = "Freezing")
write_xlsx(Summation_Fos, 'Nido_Summation_Fos.xlsx')
Summation_Novel <- Summation %>% filter(!is.na(Novel))
Summation_Novel <- Summation_Novel %>%
select(MouseID, Sex, Age, FearFreq, NovelFreq, Baseline:Novel) %>%
mutate(Discrim = Fear - Safety) %>%
mutate(Inhib = Fear - Compound) %>%
mutate(Suppression = Compound/Fear) %>%
mutate(Generalization = Summation_Novel$"Novel Compound"/Fear) %>%
pivot_longer(cols = Baseline:Generalization, names_to = "StimType", values_to = "Freezing")
write_xlsx(Summation_Novel, 'Nido_Summation_Novel.xlsx')
#### demographics ####
pnd_stats <- function(x)
{x %>% summarize(mean = mean(PND),
max = max(PND),
min = min(PND),
sd   = sd(PND),
n    = n(),
sem  = sd / sqrt(n))}
Master_DC1 <- read_xlsx(sheet = 2, 'Nidorina_masterdoc_MT8.xlsx')
Master_DC1_Adol <- Master_DC1 %>% filter(Age == "Adolescent")
Adol_age <- Master_DC1_Adol %>% pnd_stats
Master_DC1_Adult <- Master_DC1 %>% filter(Age == "Adult")
Adult_age <- Master_DC1_Adult %>% pnd_stats
View(Summation)
setwd('/Users/hcmeyer/Meyer Lab Boston University/Research/Experiments/Nidorina')
library(readxl); library(writexl);library(ggplot2); library(forcats); library(ggsci); library(patchwork); library(ez); library(rstatix); library(multcomp); library(tidyverse); library(cowplot); library(car)
fig_stats <- function(x)
{x %>% summarize(mean = mean(Freezing),
sd   = sd(Freezing),
n    = n(),
sem  = sd / sqrt(n))}
theme_set(
theme_light() +
theme(legend.justification = c(1, 1),
legend.box.margin = margin(t = 5, r = 5, b = 0, l = 0),
panel.grid = element_blank(),
text = element_text(size = 22),
title = element_text(size = 22),
legend.text = element_text(size = 18),
axis.text = element_text(size = 18),
axis.line = element_line(colour = "black", size = 0.3),
panel.border = element_blank())
)
#
#### Curate data ####
#Acquisition
SS1 <- read_xlsx(sheet = 2, 'Nidorina_masterdoc_MT8.xlsx') #All data is MT8
SS2 <- read_xlsx(sheet = 3, 'Nidorina_masterdoc_MT8.xlsx')
SS3 <- read_xlsx(sheet = 4, 'Nidorina_masterdoc_MT8.xlsx')
SS4 <- read_xlsx(sheet = 5, 'Nidorina_masterdoc_MT8.xlsx')
SS1_long <- SS1 %>%
mutate(Fear = rowMeans(x = select(.data = SS1, starts_with("Fear")))) %>%
mutate(Safety = rowMeans(x = select(.data = SS1, starts_with("Safety")))) %>%
mutate(Discrim = Fear - Safety) %>%
select(MouseID:Age, Baseline, Fear, Safety, Discrim) %>% mutate(Day = "Day1") %>%
pivot_longer(cols = Baseline:Discrim, names_to = "StimType", values_to = "Freezing")
SS2_long <- SS2 %>%
mutate(Fear = rowMeans(x = select(.data = SS2, starts_with("Fear")))) %>%
mutate(Safety = rowMeans(x = select(.data = SS2, starts_with("Safety")))) %>%
mutate(Discrim = Fear - Safety) %>%
select(MouseID:Age, Baseline, Fear, Safety, Discrim) %>% mutate(Day = "Day2") %>%
pivot_longer(cols = Baseline:Discrim, names_to = "StimType", values_to = "Freezing")
SS3_long <- SS3 %>%
mutate(Fear = rowMeans(x = select(.data = SS3, starts_with("Fear")))) %>%
mutate(Safety = rowMeans(x = select(.data = SS3, starts_with("Safety")))) %>%
mutate(Discrim = Fear - Safety) %>%
select(MouseID:Age, Baseline, Fear, Safety, Discrim) %>% mutate(Day = "Day3") %>%
pivot_longer(cols = Baseline:Discrim, names_to = "StimType", values_to = "Freezing")
SS4_long <- SS4 %>%
mutate(Fear = rowMeans(x = select(.data = SS4, starts_with("Fear")))) %>%
mutate(Safety = rowMeans(x = select(.data = SS4, starts_with("Safety")))) %>%
mutate(Discrim = Fear - Safety) %>%
select(MouseID:Age, Baseline, Fear, Safety, Discrim) %>% mutate(Day = "Day4") %>%
pivot_longer(cols = Baseline:Discrim, names_to = "StimType", values_to = "Freezing")
Acquisition <- bind_rows(SS1_long, SS2_long, SS3_long, SS4_long)
Acquisition <- Acquisition %>% filter(!is.na(Freezing))
write_xlsx(Acquisition, 'Nido_Acquisition.xlsx')
#curate the data
Summation <- read_xlsx(sheet = 7, 'Nidorina_masterdoc_MT8.xlsx')
Summation_Fos <- Summation %>%
filter(!Cohort == "1", !Cohort == "2", !Cohort == "3", !Cohort == "4", !Cohort == "5", !Cohort == "Combo") %>%
select(MouseID, Sex, Age, Baseline:Safety) %>%
mutate(Discrim = Fear - Safety) %>%
mutate(Inhib = Fear - Compound) %>%
mutate(Suppression = Compound/Fear) %>%
pivot_longer(cols = Baseline:Suppression, names_to = "StimType", values_to = "Freezing")
write_xlsx(Summation_Fos, 'Nido_Summation_Fos.xlsx')
Summation_Novel <- Summation %>% filter(!is.na(Novel))
Summation_Novel <- Summation_Novel %>%
select(MouseID, Sex, Age, FearFreq, NovelFreq, Baseline:Novel) %>%
mutate(Discrim = Fear - Safety) %>%
mutate(Inhib = Fear - Compound) %>%
mutate(Suppression = Compound/(Compound+Fear)) %>%
mutate(Generalization = Summation_Novel$"Novel Compound"/(Summation_Novel$"Novel Compound"+Fear)) %>%
pivot_longer(cols = Baseline:Generalization, names_to = "StimType", values_to = "Freezing")
write_xlsx(Summation_Novel, 'Nido_Summation_Novel.xlsx')
#### demographics ####
pnd_stats <- function(x)
{x %>% summarize(mean = mean(PND),
max = max(PND),
min = min(PND),
sd   = sd(PND),
n    = n(),
sem  = sd / sqrt(n))}
Master_DC1 <- read_xlsx(sheet = 2, 'Nidorina_masterdoc_MT8.xlsx')
Master_DC1_Adol <- Master_DC1 %>% filter(Age == "Adolescent")
Adol_age <- Master_DC1_Adol %>% pnd_stats
Master_DC1_Adult <- Master_DC1 %>% filter(Age == "Adult")
Adult_age <- Master_DC1_Adult %>% pnd_stats
#### ACQUISITION CURVES ####
#graph the data
Acquisition <- read_xlsx(sheet = 1, 'Nido_Acquisition.xlsx') #This will include ALL of the mice from the project
Acquisition_sub <- Acquisition %>% filter(Age == "Adult", !StimType == "Baseline", !StimType == "Discrim")
Acquisition_sub_stats <- Acquisition_sub %>%
group_by(StimType, Day, Sex) %>%
fig_stats %>%
unite(Group, c(Sex, StimType), sep = " ", remove = FALSE)
p_Acq <- ggplot(Acquisition_sub_stats, aes(x = Day, y = mean, group = Group)) +
geom_point(aes(shape = Sex, color = StimType), size = 4, show.legend = FALSE) +
geom_line(aes(linetype = Sex, color = StimType), lwd = 2) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.05, size = 1, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_color_manual(values=c("red3", "steelblue1")) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Average cued freezing (%)", limits = c(0, 100), breaks = seq(0, 100, 10), expand = c(0, 0))
p_Acq
Acquisition_sub <- Acquisition %>% filter(Age == "Adolescent", !StimType == "Baseline", !StimType == "Discrim")
Acquisition_sub_stats <- Acquisition_sub %>%
group_by(StimType, Day, Sex) %>%
fig_stats %>%
unite(Group, c(Sex, StimType), sep = " ", remove = FALSE)
p_Acq <- ggplot(Acquisition_sub_stats, aes(x = Day, y = mean, group = Group)) +
geom_point(aes(shape = Sex, color = StimType), size = 4, show.legend = FALSE) +
geom_line(aes(linetype = Sex, color = StimType), lwd = 2) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.05, size = 1, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_color_manual(values=c("red3", "steelblue1")) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Average cued freezing (%)", limits = c(0, 100), breaks = seq(0, 100, 10), expand = c(0, 0))
p_Acq
##### SUMMATION TEST (Fos subset) ####
Summation_Fos <- read_xlsx(sheet = 1, 'Nido_Summation_Fos.xlsx')
#graph the data
Summation <- Summation_Fos %>% filter(!StimType == "Baseline", !StimType == "Discrim", !StimType == "Inhib", !StimType == "Suppression")
Summation_Age <- Summation %>% filter(Age == "Adolescent") %>%
mutate(StimType = fct_relevel(StimType, "Fear", "Compound", "Safety"))
Summation_sub_stats <- Summation_Age %>%
mutate(StimType = fct_relevel(StimType, "Fear", "Compound", "Safety")) %>%
group_by(Sex, StimType) %>% fig_stats
p_Summation <- ggplot(Summation_sub_stats, aes(x = Sex, y = mean, fill = StimType)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = Summation_Age, inherit.aes = FALSE,
aes(x = Sex, y = Freezing, fill = StimType, group = StimType), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 0.7, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("Average cued freezing (%)", limits = c(0, 100), breaks = seq(0, 100, 10), expand = c(0, 1)) +
scale_fill_manual(name = NULL, values = c("red3", "purple3", "steelblue1")) +
theme(legend.position = c(1.1,1.05))
p_Summation
#graph the data
Summation <- Summation_Fos %>% filter(!StimType == "Baseline", !StimType == "Discrim", !StimType == "Inhib", !StimType == "Suppression")
Summation_Age <- Summation %>% filter(Age == "Adult") %>%
mutate(StimType = fct_relevel(StimType, "Fear", "Compound", "Safety"))
Summation_sub_stats <- Summation_Age %>%
mutate(StimType = fct_relevel(StimType, "Fear", "Compound", "Safety")) %>%
group_by(Sex, StimType) %>% fig_stats
p_Summation <- ggplot(Summation_sub_stats, aes(x = Sex, y = mean, fill = StimType)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = Summation_Age, inherit.aes = FALSE,
aes(x = Sex, y = Freezing, fill = StimType, group = StimType), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 0.7, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("Average cued freezing (%)", limits = c(0, 100), breaks = seq(0, 100, 10), expand = c(0, 1)) +
scale_fill_manual(name = NULL, values = c("red3", "purple3", "steelblue1")) +
theme(legend.position = c(1.1,1.05))
p_Summation
##### SUMMATION TEST (Novel subset - all mice) #####
Summation_Novel <- read_xlsx(sheet = 1, 'Nido_Summation_Novel.xlsx')
#graph the data
Novelty <- Summation_Novel %>%
filter(!StimType == "Baseline", !StimType == "Discrim", !StimType == "Inhib",
!StimType == "Suppression", !StimType == "Generalization") %>%
select(MouseID, Sex, Age, StimType, Freezing)
Novelty_Age <- Novelty %>% filter(Age == "Adolescent") %>%
mutate(StimType = fct_relevel(StimType, "Fear", "Compound", "Safety", "Novel Compound", "Novel"))
Novelty_sub_stats <- Novelty_Age %>%
mutate(StimType = fct_relevel(StimType, "Fear", "Compound", "Safety", "Novel Compound", "Novel")) %>%
group_by(Sex, StimType) %>% fig_stats
p_Novelty <- ggplot(Novelty_sub_stats, aes(x = Sex, y = mean, fill = StimType)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = Novelty_Age, inherit.aes = FALSE,
aes(x = Sex, y = Freezing, fill = StimType, group = StimType), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 0.7, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("Average cued freezing (%)", limits = c(0, 100), breaks = seq(0, 100, 10), expand = c(0, 1)) +
scale_fill_manual(name = NULL, values = c("red3", "purple3", "steelblue1", "turquoise", "orange")) +
theme(legend.position = "right")
p_Novelty
#graph the data
Novelty <- Summation_Novel %>%
filter(!StimType == "Baseline", !StimType == "Discrim", !StimType == "Inhib",
!StimType == "Suppression", !StimType == "Generalization") %>%
select(MouseID, Sex, Age, StimType, Freezing)
Novelty_Age <- Novelty %>% filter(Age == "Adult") %>%
mutate(StimType = fct_relevel(StimType, "Fear", "Compound", "Safety", "Novel Compound", "Novel"))
Novelty_sub_stats <- Novelty_Age %>%
mutate(StimType = fct_relevel(StimType, "Fear", "Compound", "Safety", "Novel Compound", "Novel")) %>%
group_by(Sex, StimType) %>% fig_stats
p_Novelty <- ggplot(Novelty_sub_stats, aes(x = Sex, y = mean, fill = StimType)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = Novelty_Age, inherit.aes = FALSE,
aes(x = Sex, y = Freezing, fill = StimType, group = StimType), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 0.7, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("Average cued freezing (%)", limits = c(0, 100), breaks = seq(0, 100, 10), expand = c(0, 1)) +
scale_fill_manual(name = NULL, values = c("red3", "purple3", "steelblue1", "turquoise", "orange")) +
theme(legend.position = "right")
p_Novelty
#setwd('/Users/hcmeyer/Meyer Lab Boston University/Research/Experiments/Nidorina')
library(readxl); library(writexl);library(ggplot2); library(forcats); library(ggsci); library(patchwork); library(ez); library(rstatix); library(multcomp); library(tidyverse); library(cowplot); library(car)
fig_stats <- function(x)
{x %>% summarize(mean = mean(Freezing),
sd   = sd(Freezing),
n    = n(),
sem  = sd / sqrt(n))}
theme_set(
theme_light() +
theme(legend.justification = c(1, 1),
legend.box.margin = margin(t = 5, r = 5, b = 0, l = 0),
panel.grid = element_blank(),
text = element_text(size = 22),
title = element_text(size = 22),
legend.text = element_text(size = 18),
axis.text = element_text(size = 18),
axis.line = element_line(colour = "black", size = 0.3),
panel.border = element_blank())
)
#
#### Curate data ####
#Acquisition
SS1 <- read_xlsx(sheet = 2, 'Nidorina_masterdoc_MT8.xlsx') #All data is MT8
SS2 <- read_xlsx(sheet = 3, 'Nidorina_masterdoc_MT8.xlsx')
SS3 <- read_xlsx(sheet = 4, 'Nidorina_masterdoc_MT8.xlsx')
SS4 <- read_xlsx(sheet = 5, 'Nidorina_masterdoc_MT8.xlsx')
SS1_long <- SS1 %>%
mutate(Fear = rowMeans(x = select(.data = SS1, starts_with("Fear")))) %>%
mutate(Safety = rowMeans(x = select(.data = SS1, starts_with("Safety")))) %>%
mutate(Discrim = Fear - Safety) %>%
select(MouseID:Age, Baseline, Fear, Safety, Discrim) %>% mutate(Day = "Day1") %>%
pivot_longer(cols = Baseline:Discrim, names_to = "StimType", values_to = "Freezing")
SS2_long <- SS2 %>%
mutate(Fear = rowMeans(x = select(.data = SS2, starts_with("Fear")))) %>%
mutate(Safety = rowMeans(x = select(.data = SS2, starts_with("Safety")))) %>%
mutate(Discrim = Fear - Safety) %>%
select(MouseID:Age, Baseline, Fear, Safety, Discrim) %>% mutate(Day = "Day2") %>%
pivot_longer(cols = Baseline:Discrim, names_to = "StimType", values_to = "Freezing")
SS3_long <- SS3 %>%
mutate(Fear = rowMeans(x = select(.data = SS3, starts_with("Fear")))) %>%
mutate(Safety = rowMeans(x = select(.data = SS3, starts_with("Safety")))) %>%
mutate(Discrim = Fear - Safety) %>%
select(MouseID:Age, Baseline, Fear, Safety, Discrim) %>% mutate(Day = "Day3") %>%
pivot_longer(cols = Baseline:Discrim, names_to = "StimType", values_to = "Freezing")
SS4_long <- SS4 %>%
mutate(Fear = rowMeans(x = select(.data = SS4, starts_with("Fear")))) %>%
mutate(Safety = rowMeans(x = select(.data = SS4, starts_with("Safety")))) %>%
mutate(Discrim = Fear - Safety) %>%
select(MouseID:Age, Baseline, Fear, Safety, Discrim) %>% mutate(Day = "Day4") %>%
pivot_longer(cols = Baseline:Discrim, names_to = "StimType", values_to = "Freezing")
Acquisition <- bind_rows(SS1_long, SS2_long, SS3_long, SS4_long)
Acquisition <- Acquisition %>% filter(!is.na(Freezing))
write_xlsx(Acquisition, 'Nido_Acquisition.xlsx')
#curate the data
Summation <- read_xlsx(sheet = 7, 'Nidorina_masterdoc_MT8.xlsx')
Summation_Fos <- Summation %>%
filter(!Cohort == "1", !Cohort == "2", !Cohort == "3", !Cohort == "4", !Cohort == "5", !Cohort == "Combo") %>%
select(MouseID, Sex, Age, Baseline:Safety) %>%
mutate(Discrim = Fear - Safety) %>%
mutate(Inhib = Fear - Compound) %>%
mutate(Suppression = Compound/Fear) %>%
pivot_longer(cols = Baseline:Suppression, names_to = "StimType", values_to = "Freezing")
write_xlsx(Summation_Fos, 'Nido_Summation_Fos.xlsx')
Summation_Novel <- Summation %>% filter(!is.na(Novel))
Summation_Novel <- Summation_Novel %>%
select(MouseID, Sex, Age, FearFreq, NovelFreq, Baseline:Novel) %>%
mutate(Discrim = Fear - Safety) %>%
mutate(Inhib = Fear - Compound) %>%
mutate(Suppression = Compound/(Compound+Fear)) %>%
mutate(Generalization = Summation_Novel$"Novel Compound"/(Summation_Novel$"Novel Compound"+Fear)) %>%
pivot_longer(cols = Baseline:Generalization, names_to = "StimType", values_to = "Freezing")
write_xlsx(Summation_Novel, 'Nido_Summation_Novel.xlsx')
#### demographics ####
pnd_stats <- function(x)
{x %>% summarize(mean = mean(PND),
max = max(PND),
min = min(PND),
sd   = sd(PND),
n    = n(),
sem  = sd / sqrt(n))}
Master_DC1 <- read_xlsx(sheet = 2, 'Nidorina_masterdoc_MT8.xlsx')
Master_DC1_Adol <- Master_DC1 %>% filter(Age == "Adolescent")
Adol_age <- Master_DC1_Adol %>% pnd_stats
Master_DC1_Adult <- Master_DC1 %>% filter(Age == "Adult")
Adult_age <- Master_DC1_Adult %>% pnd_stats
#### ACQUISITION CURVES ####
#graph the data
Acquisition <- read_xlsx(sheet = 1, 'Nido_Acquisition.xlsx') #This will include ALL of the mice from the project
Acquisition_sub <- Acquisition %>% filter(Age == "Adult", !StimType == "Baseline", !StimType == "Discrim")
Acquisition_sub_stats <- Acquisition_sub %>%
group_by(StimType, Day, Sex) %>%
fig_stats %>%
unite(Group, c(Sex, StimType), sep = " ", remove = FALSE)
p_Acq <- ggplot(Acquisition_sub_stats, aes(x = Day, y = mean, group = Group)) +
geom_point(aes(shape = Sex, color = StimType), size = 4, show.legend = FALSE) +
geom_line(aes(linetype = Sex, color = StimType), lwd = 2) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem), width = 0.05, size = 1, color = "black") +
scale_shape_manual(values=c(19, 1)) +
scale_color_manual(values=c("red3", "steelblue1")) +
scale_x_discrete(name = NULL, labels = (c("Day 1", "Day 2", "Day 3","Day 4"))) +
scale_y_continuous("Average cued freezing (%)", limits = c(0, 100), breaks = seq(0, 100, 10), expand = c(0, 0))
p_Acq
##### SUMMATION TEST (Fos subset) ####
Summation_Fos <- read_xlsx(sheet = 1, 'Nido_Summation_Fos.xlsx')
#graph the data
Summation <- Summation_Fos %>% filter(!StimType == "Baseline", !StimType == "Discrim", !StimType == "Inhib", !StimType == "Suppression")
Summation_Age <- Summation %>% filter(Age == "Adolescent") %>%
mutate(StimType = fct_relevel(StimType, "Fear", "Compound", "Safety"))
Summation_sub_stats <- Summation_Age %>%
mutate(StimType = fct_relevel(StimType, "Fear", "Compound", "Safety")) %>%
group_by(Sex, StimType) %>% fig_stats
p_Summation <- ggplot(Summation_sub_stats, aes(x = Sex, y = mean, fill = StimType)) +
geom_col(position = position_dodge2(width = 0.7)) +
geom_point(data = Summation_Age, inherit.aes = FALSE,
aes(x = Sex, y = Freezing, fill = StimType, group = StimType), show.legend = FALSE,
position = position_jitterdodge(jitter.width = 0.15, dodge.width = 0.9), alpha = 0.5, shape = 21, stroke = 1, size = 3) +
geom_errorbar(aes(ymin = mean - sem, ymax = mean + sem),
width = 0.1, size = 0.7, position = position_dodge(width = 0.9)) +
scale_x_discrete(name = NULL) +
scale_y_continuous("Average cued freezing (%)", limits = c(0, 100), breaks = seq(0, 100, 10), expand = c(0, 1)) +
scale_fill_manual(name = NULL, values = c("red3", "purple3", "steelblue1")) +
theme(legend.position = c(1.1,1.05))
p_Summation
